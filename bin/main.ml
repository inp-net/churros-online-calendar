let code = {|
{
  "data": {
    "homepage": {
      "nodes": [
        {
          "uid": "kfet-gala-des-lvo-1406",
          "group": {
            "name": "K'Fet de nuit",
            "pictureFile": "groups/kfetnuit-ensat.png",
            "pictureFileDark": ""
          },
          "title": "KFET Gala des LVO 14/06",
          "notifiedAt": "2024-06-12T18:40:11.551Z",
          "event": {
            "title": "KFET du Gala des LVO",
            "location": "ENSAT",
            "startsAt": "2024-06-14T20:00:00.000Z",
            "endsAt": "2024-06-15T00:30:00.000Z"
          },
          "id": "a:pgviuexfvu3gky0k",
          "bodyPreview": "N'oublie pas de prendre ta places pour la superbe Kfet du gala des LVO !",
          "reactionCounts": "{\"‚ù§Ô∏è\":3}"
        },
        {
          "uid": "prenez-vos-places-8",
          "group": {
            "name": "Foyer",
            "pictureFile": "groups/foyer-n7.png",
            "pictureFileDark": ""
          },
          "title": "Prenez vos places !",
          "notifiedAt": "2024-05-01T13:10:16.281Z",
          "event": {
            "title": "[BBQ Foy x ClubZik]",
            "location": "FOY",
            "startsAt": "2024-05-04T16:00:00.000Z",
            "endsAt": "2024-05-04T20:00:00.000Z"
          },
          "id": "a:uhc2brdutpcdgt0h",
          "bodyPreview": "",
          "reactionCounts": "{\"‚ù§Ô∏è\":2}"
        },
        {
          "uid": "prenez-vos-places-6",
          "group": {
            "name": "Foyer",
            "pictureFile": "groups/foyer-n7.png",
            "pictureFileDark": ""
          },
          "title": "Prenez vos places !!",
          "notifiedAt": "2024-04-22T11:19:01.215Z",
          "event": {
            "title": "[AW ESCAPE7]",
            "location": "",
            "startsAt": "2024-04-23T16:00:00.000Z",
            "endsAt": "2024-04-23T19:00:00.000Z"
          },
          "id": "a:fwyqdgklgq92ssux",
          "bodyPreview": "",
          "reactionCounts": "{}"
        },
        {
          "uid": "workshop-astre-2024",
          "group": {
            "name": "ASTRE",
            "pictureFile": "groups/astre-n7.png",
            "pictureFileDark": ""
          },
          "title": "Workshop ASTRE 2024",
          "notifiedAt": "2024-03-22T07:51:35.530Z",
          "event": {
            "title": "Workshop ASTRE",
            "location": "Discord ASTRE",
            "startsAt": "2024-03-23T16:00:00.000Z",
            "endsAt": "2024-03-23T18:00:00.000Z"
          },
          "id": "a:qcnn9i8lb77wzhjp",
          "bodyPreview": "Tu es int√©ress√© par des projets en lien avec le spatial ? Tu veux construire une",
          "reactionCounts": "{\"‚ù§Ô∏è\":1}"
        },
        {
          "uid": "ctf-par-net7-la-semaine-prochaine",
          "group": {
            "name": "net7",
            "pictureFile": "groups/net7-n7.png",
            "pictureFileDark": "groups/dark/net7-n7.png"
          },
          "title": "CTF par net7 la semaine prochaine !",
          "notifiedAt": null,
          "event": null,
          "id": "a:11xqwzrh7gmsyvdc",
          "bodyPreview": "Salut √† tous !",
          "reactionCounts": "{\"‚ù§Ô∏è\":9}"
        },
        {
          "uid": "recrutement-astre-mars-2024",
          "group": {
            "name": "ASTRE",
            "pictureFile": "groups/astre-n7.png",
            "pictureFileDark": ""
          },
          "title": "Recrutement ASTRE - Mars 2024",
          "notifiedAt": "2024-03-18T12:54:45.881Z",
          "event": {
            "title": "Recrutement ASTRE - Mars 2024",
            "location": "",
            "startsAt": "2024-03-18T13:44:00.000Z",
            "endsAt": "2024-03-26T22:59:00.000Z"
          },
          "id": "a:msqhuiehwig3y0bx",
          "bodyPreview": "Bonjour √† tous,",
          "reactionCounts": "{\"‚ù§Ô∏è\":2}"
        },
        {
          "uid": "soiree-boite",
          "group": {
            "name": "Ber7ker",
            "pictureFile": "groups/ber7ker.png",
            "pictureFileDark": "groups/dark/ber7ker.png"
          },
          "title": "Soir√©e Boite",
          "notifiedAt": "2024-03-17T06:52:10.331Z",
          "event": null,
          "id": "a:5nhzxmyx6geb1my8",
          "bodyPreview": "ü™ìLes vikings ne choisissaient pas quand ils devaient combattre.",
          "reactionCounts": "{}"
        },
        {
          "uid": "entre-climatoscepticisme-et-eco-anxiete-quel-est-notre-rapport-a-linformation",
          "group": {
            "name": "Bureau du D√©veloppement Durable",
            "pictureFile": "groups/bdd-n7.png",
            "pictureFileDark": "groups/dark/bdd-n7.png"
          },
          "title": "Entre climatoscepticisme et √©co-anxi√©t√©, quel est notre rapport √† l'information?",
          "notifiedAt": "2024-03-15T12:51:28.506Z",
          "event": {
            "title": "Table ronde BDD sur le climatoscepticisme et l'√©coanxi√©t√©",
            "location": "Amphi B00 N7",
            "startsAt": "2024-03-20T17:00:00.000Z",
            "endsAt": "2024-03-20T19:00:00.000Z"
          },
          "id": "a:d8d6mcnijiokyfai",
          "bodyPreview": "Bonjour √† tous!",
          "reactionCounts": "{}"
        },
        {
          "uid": "prenez-vos-places-7",
          "group": {
            "name": "Foyer",
            "pictureFile": "groups/foyer-n7.png",
            "pictureFileDark": ""
          },
          "title": "Prenez vos places ",
          "notifiedAt": "2024-03-07T15:05:38.680Z",
          "event": {
            "title": "[AW 7FAULT x CARTEL]",
            "location": "Foy",
            "startsAt": "2024-03-08T17:00:00.000Z",
            "endsAt": "2024-03-08T20:00:00.000Z"
          },
          "id": "a:p1wumnhenruqfwzg",
          "bodyPreview": "",
          "reactionCounts": "{\"‚ù§Ô∏è\":2}"
        },
        {
          "uid": "prenez-vos-places-maintenant",
          "group": {
            "name": "Foyer",
            "pictureFile": "groups/foyer-n7.png",
            "pictureFileDark": ""
          },
          "title": "Prenez vos places maintenant",
          "notifiedAt": "2024-02-27T12:39:56.808Z",
          "event": {
            "title": "[AW D√âCOS GALA]",
            "location": "FOY",
            "startsAt": "2024-02-28T17:00:00.000Z",
            "endsAt": "2024-02-28T23:00:00.000Z"
          },
          "id": "a:ehhyzccrrknqih56",
          "bodyPreview": "",
          "reactionCounts": "{}"
        }
      ]
    }
  }
}
|}

let _ =
  let lexbuf = Lexing.from_string code in
  let parsed_opt = Parser.file Lexer.token lexbuf in
  let parsed = Option.get parsed_opt in
  print_endline (Syntax.show_t_json parsed)
